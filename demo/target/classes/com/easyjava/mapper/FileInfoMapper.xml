<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.easyjava.mapper.FileInfoMapper">
	<resultMap id="base_result_map" type="com.easyjava.entity.po.FileInfo">
		<!--flie id-->
		<result column="file_id" property="fileId"/>
		<!--user id-->
		<result column="user_id" property="userId"/>
		<!--文件MD5值-->
		<result column="file_md5" property="fileMd5"/>
		<!--父级目录id-->
		<result column="file_pid" property="filePid"/>
		<!--文件总字节大小-->
		<result column="file_size" property="fileSize"/>
		<!--文件名-->
		<result column="file_name" property="fileName"/>
		<!--封面-->
		<result column="file_cover" property="fileCover"/>
		<!--文件路径-->
		<result column="file_path" property="filePath"/>
		<!--上传时间-->
		<result column="create_time" property="createTime"/>
		<!--最后更新时间-->
		<result column="last_update_time" property="lastUpdateTime"/>
		<!--目录标志位0:文件；1：目录-->
		<result column="folder_type" property="folderType"/>
		<!--文件大致分类1：视频 2：音频 3：图片 4：文档 5：其他-->
		<result column="file_category" property="fileCategory"/>
		<!--文件细致分类1：视频 2：音频 3：图片 4：pdf 5:doc 6:excel 7:txt 8:code 9:zip 10:其他-->
		<result column="file_type" property="fileType"/>
		<!--转码状态0：转码中 1：转码失败 2：转码成功-->
		<result column="status" property="status"/>
		<!--进入回收站时间-->
		<result column="recovery_time" property="recoveryTime"/>
		<!--删除标志位1：回收站 2：正常-->
		<result column="del_flag" property="delFlag"/>
		<!--文件后缀名-->
		<result column="file_suffix" property="fileSuffix"/>
	</resultMap>
	<sql id="base_column_list">
		fileId,userId,fileMd5,filePid,fileSize,fileName,fileCover,filePath,createTime,lastUpdateTime,folderType,fileCategory,fileType,status,recoveryTime,delFlag,fileSuffix
	</sql>
	<sql id="base_condition_list">
		<if test="fileId != null and fileId!=''">
			and fileId=#{query.fileId}
		</if>
		<if test="userId != null and userId!=''">
			and userId=#{query.userId}
		</if>
		<if test="fileMd5 != null and fileMd5!=''">
			and fileMd5=#{query.fileMd5}
		</if>
		<if test="filePid != null and filePid!=''">
			and filePid=#{query.filePid}
		</if>
		<if test="fileSize != null">
			and fileSize=#{query.fileSize}
		</if>
		<if test="fileName != null and fileName!=''">
			and fileName=#{query.fileName}
		</if>
		<if test="fileCover != null and fileCover!=''">
			and fileCover=#{query.fileCover}
		</if>
		<if test="filePath != null and filePath!=''">
			and filePath=#{query.filePath}
		</if>
		<if test="createTime != null">
			and createTime=#{query.createTime}
		</if>
		<if test="lastUpdateTime != null">
			and lastUpdateTime=#{query.lastUpdateTime}
		</if>
		<if test="folderType != null">
			and folderType=#{query.folderType}
		</if>
		<if test="fileCategory != null">
			and fileCategory=#{query.fileCategory}
		</if>
		<if test="fileType != null">
			and fileType=#{query.fileType}
		</if>
		<if test="status != null">
			and status=#{query.status}
		</if>
		<if test="recoveryTime != null">
			and recoveryTime=#{query.recoveryTime}
		</if>
		<if test="delFlag != null">
			and delFlag=#{query.delFlag}
		</if>
		<if test="fileSuffix != null and fileSuffix!=''">
			and fileSuffix=#{query.fileSuffix}
		</if>
	</sql>
	<sql id="query_condition_list">
		<if test="fileIdFuzzy != null and fileIdFuzzy!=''">
			and file_id like concat('%', #{query.fileIdFuzzy}, '%')
		</if>
		<if test="userIdFuzzy != null and userIdFuzzy!=''">
			and user_id like concat('%', #{query.userIdFuzzy}, '%')
		</if>
		<if test="fileMd5Fuzzy != null and fileMd5Fuzzy!=''">
			and file_md5 like concat('%', #{query.fileMd5Fuzzy}, '%')
		</if>
		<if test="filePidFuzzy != null and filePidFuzzy!=''">
			and file_pid like concat('%', #{query.filePidFuzzy}, '%')
		</if>
		<if test="fileNameFuzzy != null and fileNameFuzzy!=''">
			and file_name like concat('%', #{query.fileNameFuzzy}, '%')
		</if>
		<if test="fileCoverFuzzy != null and fileCoverFuzzy!=''">
			and file_cover like concat('%', #{query.fileCoverFuzzy}, '%')
		</if>
		<if test="filePathFuzzy != null and filePathFuzzy!=''">
			and file_path like concat('%', #{query.filePathFuzzy}, '%')
		</if>
		<if test="createTimeStart != null and createTimeStart!=''">
			<![CDATA[ and create_time > str_to_date(#{createTimeStart}, '%Y-%m-%d')]]>
		</if>
		<if test="createTimeEnd != null and createTimeEnd!=''">
			<![CDATA[ and create_time < DATE_SUB( str_to_date(#{createTimeEnd}, '%Y-%m-%d'), interval 1 DAY)]]>
		</if>
		<if test="lastUpdateTimeStart != null and lastUpdateTimeStart!=''">
			<![CDATA[ and last_update_time > str_to_date(#{lastUpdateTimeStart}, '%Y-%m-%d')]]>
		</if>
		<if test="lastUpdateTimeEnd != null and lastUpdateTimeEnd!=''">
			<![CDATA[ and last_update_time < DATE_SUB( str_to_date(#{lastUpdateTimeEnd}, '%Y-%m-%d'), interval 1 DAY)]]>
		</if>
		<if test="recoveryTimeStart != null and recoveryTimeStart!=''">
			<![CDATA[ and recovery_time > str_to_date(#{recoveryTimeStart}, '%Y-%m-%d')]]>
		</if>
		<if test="recoveryTimeEnd != null and recoveryTimeEnd!=''">
			<![CDATA[ and recovery_time < DATE_SUB( str_to_date(#{recoveryTimeEnd}, '%Y-%m-%d'), interval 1 DAY)]]>
		</if>
		<if test="fileSuffixFuzzy != null and fileSuffixFuzzy!=''">
			and file_suffix like concat('%', #{query.fileSuffixFuzzy}, '%')
		</if>
	</sql>
	<sql id="base_condition">
		<where>
			<include refid='base_condition_list'/>
		</where>
	</sql>
	<sql id="base_condition_extend">
		<where>
			<include refid='base_condition_list'/>
			<include refid='query_condition_list'/>
		</where>
	</sql>

</mapper>